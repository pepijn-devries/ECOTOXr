<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Download and Extract Data from US EPA's ECOTOX Database • ECOTOXr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Download and Extract Data from US EPA's ECOTOX Database">
<meta name="description" content="The US EPA ECOTOX database is a freely available database with a treasure of aquatic and terrestrial ecotoxicological data. As the online search interface doesn't come with an API, this package provides the means to easily access and search the database in R. To this end, all raw tables are downloaded from the EPA website and stored in a local SQLite database. &lt;10.1016/j.chemosphere.2024.143078&gt;">
<meta property="og:description" content="The US EPA ECOTOX database is a freely available database with a treasure of aquatic and terrestrial ecotoxicological data. As the online search interface doesn't come with an API, this package provides the means to easily access and search the database in R. To this end, all raw tables are downloaded from the EPA website and stored in a local SQLite database. &lt;10.1016/j.chemosphere.2024.143078&gt;">
<meta property="og:image" content="https://pepijn-devries.github.io/ECOTOXr/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ECOTOXr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.0001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pepijn-devries/ECOTOXr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="ecotoxr">
<code>ECOTOXr</code><a class="anchor" aria-label="anchor" href="#ecotoxr"></a>
</h1>
</div>
<blockquote>
<p>Harness information from the <a href="https://cfpub.epa.gov/ecotox/" class="external-link">US EPA ECOTOXicology Knowledgebase</a></p>
</blockquote>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><a href="https://github.com/pepijn-devries/ECOTOXr/" class="external-link"></a> <code>ECOTOXr</code> can be used to explore and analyse data from the <a href="https://cfpub.epa.gov/ecotox/" class="external-link">US EPA ECOTOX database</a>. More specifically you can:</p>
<ul>
<li>Build a local SQLite copy of the <a href="https://cfpub.epa.gov/ecotox/" class="external-link">US EPA ECOTOX database</a>
</li>
<li>Search and extract data from the local database</li>
<li>Use experimental features to search the on-line dashboards: <a href="https://cfpub.epa.gov/ecotox/search.cfm" class="external-link">ECOTOX</a> and <a href="https://comptox.epa.gov/dashboard/batch-search" class="external-link">CompTox</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="why-use-ecotoxr">Why use <code>ECOTOXr</code>?<a class="anchor" aria-label="anchor" href="#why-use-ecotoxr"></a>
</h2>
<p>The <code>ECOTOXr</code> package allows you to search and extract data from the <a href="https://cfpub.epa.gov/ecotox/" class="external-link">ECOTOXicological Knowledgebase</a> and import it directly into <code>R</code>. This will allow you to formalize and document the search- and extract-procedures in <code>R</code> code. This makes it easier to share and reproduce such procedures and its results. Moreover, you can directly apply any statistical analysis offered in <code>R</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<blockquote>
<p>Get CRAN version</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ECOTOXr"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Get development version from r-universe</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ECOTOXr"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://pepijn-devries.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="preparing-the-database">Preparing the database<a class="anchor" aria-label="anchor" href="#preparing-the-database"></a>
</h3>
<p>Although <code>ECOTOXr</code> has experimental features to search the on-line database. The package will reach its full potential when you build a copy of the database on your local machine.</p>
<blockquote>
<p>Download and build a local copy of the latest ASCII export of the US EPA ECOTOX database</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/download_ecotox_data.html">download_ecotox_data</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="searching-the-local-database-for-species-and-substances">Searching the local database for species and substances<a class="anchor" aria-label="anchor" href="#searching-the-local-database-for-species-and-substances"></a>
</h3>
<p>Obviously, searching the local database is only possible after the download and build is ready (see previous section).</p>
<blockquote>
<p>Search the local database for tests of water flea Daphnia magna exposed to benzene</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/search_ecotox.html">search_ecotox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    latin_name    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>terms <span class="op">=</span> <span class="st">"Daphnia magna"</span>, method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span>,</span>
<span>    chemical_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>terms <span class="op">=</span> <span class="st">"benzene"</span>,       method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="three-ways-of-querying-the-local-database">Three ways of querying the local database<a class="anchor" aria-label="anchor" href="#three-ways-of-querying-the-local-database"></a>
</h3>
<p>Let’s have a look at 3 different approaches for retrieving a specific record from the local database, using the unique identifier <code>result_id</code>. The first option is to use the build in <code>search_ecotox</code> function. It uses simple <code>R</code> syntax and allows you to search and collect any field from any table in the database. Furthermore, all requested output fields are automatically joined to the result without the end-user needing to know anything about the database structure.</p>
<blockquote>
<p>Using the prefab function <code>search_ecotox</code> packaged by <code>ECOTOXr</code></p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/search_ecotox.html">search_ecotox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    result_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>terms <span class="op">=</span> <span class="st">"401386"</span>, method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  as_data_frame <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 'dose_responses.response_site' was renamed 'dose_link_response_site'</span></span>
<span><span class="co">#&gt; 'chemicals.cas_number' was renamed 'test_cas'</span></span>
<span><span class="co">#&gt; 'chemicals.chemical_name' was renamed 'test_chemical'</span></span>
<span><span class="co">#&gt; 'dose_responses.dose_resp_id' was renamed 'dose_link_dose_resp_id'</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 98</span></span>
<span><span class="co">#&gt;   test_cas test_grade test_grade_comments test_purity_mean_op test_purity_mean</span></span>
<span><span class="co">#&gt; *    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               &lt;chr&gt;               &lt;chr&gt;           </span></span>
<span><span class="co">#&gt; 1    71432 NR         ""                  ""                  NR              </span></span>
<span><span class="co">#&gt; # ℹ 93 more variables: test_purity_min_op &lt;chr&gt;, test_purity_min &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   test_purity_max_op &lt;chr&gt;, test_purity_max &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   test_purity_comments &lt;chr&gt;, organism_lifestage &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   organism_age_mean_op &lt;chr&gt;, organism_age_mean &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   organism_age_min_op &lt;chr&gt;, organism_age_min &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   organism_age_max_op &lt;chr&gt;, organism_age_max &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   exposure_duration_mean_op &lt;chr&gt;, exposure_duration_mean &lt;chr&gt;, …</span></span></code></pre></div>
<p>If you like to use <a href="https://dplyr.tidyverse.org/" class="external-link"><code>dplyr</code></a> verbs, you are in luck. SQLite database can be approached using <code>dplyr</code> verbs. This approach will only return information from the <code>results</code> table. The end-user will have to join other information (like test species and test substance) manually. This does require knowledge of the database structure.</p>
<blockquote>
<p>Using <code>dplyr</code> verbs</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnectEcotox.html">dbConnectEcotox</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"results"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">result_id</span> <span class="op">==</span> <span class="st">"401386"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 137</span></span>
<span><span class="co">#&gt;   result_id test_id sample_size_mean_op sample_size_mean sample_size_min_op</span></span>
<span><span class="co">#&gt;       &lt;int&gt;   &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;            &lt;chr&gt;             </span></span>
<span><span class="co">#&gt; 1    401386 1020021 ""                  NC               ""                </span></span>
<span><span class="co">#&gt; # ℹ 132 more variables: sample_size_min &lt;chr&gt;, sample_size_max_op &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   sample_size_max &lt;chr&gt;, sample_size_unit &lt;chr&gt;, sample_size_comments &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_mean_op &lt;chr&gt;, obs_duration_mean &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_min_op &lt;chr&gt;, obs_duration_min &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_max_op &lt;chr&gt;, obs_duration_max &lt;chr&gt;, obs_duration_unit &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_comments &lt;chr&gt;, endpoint &lt;chr&gt;, endpoint_comments &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   trend &lt;chr&gt;, effect &lt;chr&gt;, effect_comments &lt;chr&gt;, measurement &lt;chr&gt;, …</span></span></code></pre></div>
<p>If you prefer working using <code>SQL</code> directly, that is fine too. The <a href="https://cran.r-project.org/package=RSQLite" class="external-link"><code>RSQLite</code></a> package allows you to get queries using <code>SQL</code> statements. The result is identical to that of the previous approach. Here too the end-user needs knowledge of the database structure in order to join additional data.</p>
<blockquote>
<p>Using <code>SQL</code> syntax</p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT * FROM results WHERE result_id='401386'"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 137</span></span>
<span><span class="co">#&gt;   result_id test_id sample_size_mean_op sample_size_mean sample_size_min_op</span></span>
<span><span class="co">#&gt;       &lt;int&gt;   &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;            &lt;chr&gt;             </span></span>
<span><span class="co">#&gt; 1    401386 1020021 ""                  NC               ""                </span></span>
<span><span class="co">#&gt; # ℹ 132 more variables: sample_size_min &lt;chr&gt;, sample_size_max_op &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   sample_size_max &lt;chr&gt;, sample_size_unit &lt;chr&gt;, sample_size_comments &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_mean_op &lt;chr&gt;, obs_duration_mean &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_min_op &lt;chr&gt;, obs_duration_min &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_max_op &lt;chr&gt;, obs_duration_max &lt;chr&gt;, obs_duration_unit &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   obs_duration_comments &lt;chr&gt;, endpoint &lt;chr&gt;, endpoint_comments &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   trend &lt;chr&gt;, effect &lt;chr&gt;, effect_comments &lt;chr&gt;, measurement &lt;chr&gt;, …</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="disclaimers">Disclaimers<a class="anchor" aria-label="anchor" href="#disclaimers"></a>
</h2>
<p>It is the end-users own responsibility to check the quality of collected data, using the original referenced source in order to evaluate its fitness for use, see also: <a href="https://cfpub.epa.gov/ecotox/help.cfm#info-limitations" class="external-link uri">https://cfpub.epa.gov/ecotox/help.cfm#info-limitations</a>.</p>
<p>Note that the package maintainer is not affiliated with the US EPA, this package is therefore <strong>not</strong> official US EPA software.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<ul>
<li>De Vries, P. (2024) ECOTOXr: An R package for reproducible and transparent retrieval of data from EPA’s ECOTOX database. <em>Chemosphere</em> 364 143078 <a href="https://doi.org/10.1016/j.chemosphere.2024.143078" class="external-link uri">https://doi.org/10.1016/j.chemosphere.2024.143078</a>
</li>
<li><a href="https://CRAN.R-project.org/package=ECOTOXr" class="external-link">Manual of the CRAN release</a></li>
<li>EPA ECOTOX help <a href="https://cfpub.epa.gov/ecotox/help.cfm" class="external-link uri">https://cfpub.epa.gov/ecotox/help.cfm</a>
</li>
<li>Olker, Jennifer H.; Elonen, Colleen M.; Pilli, Anne; Anderson, Arne; Kinziger, Brian; Erickson, Stephen; Skopinski, Michael; Pomplun, Anita; LaLone, Carlie A.; Russom, Christine L.; Hoff, Dale. (2022): The ECOTOXicology Knowledgebase: A Curated Database of Ecologically Relevant Toxicity Tests to Support Environmental Research and Risk Assessment. <em>Environmental Toxicology and Chemistry</em> 41(6) 1520-1539 <a href="https://doi.org/10.1002/etc.5324" class="external-link uri">https://doi.org/10.1002/etc.5324</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ECOTOXr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/pepijn-devries/ECOTOXr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/pepijn-devries/ECOTOXr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ECOTOXr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pepijn de Vries <br><small class="roles"> Author, maintainer, data contributor </small> <a href="https://orcid.org/0000-0002-7961-6646" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/pepijn-devries/ECOTOXr/actions" class="external-link"><img src="https://github.com/pepijn-devries/ECOTOXr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://CRAN.R-project.org/package=ECOTOXr" class="external-link"><img src="https://www.r-pkg.org/badges/version/ECOTOXr" alt="version"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pepijn de Vries.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
